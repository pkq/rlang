<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Is object a formula? — is_formula • rlang</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Is object a formula? — is_formula" />
<meta property="og:description" content="is_formula() tests whether x is a call to ~. is_bare_formula()
tests in addition that x does not inherit from anything else than
&quot;formula&quot;.
Note: When we first implemented is_formula(), we thought it
best to treat unevaluated formulas as formulas by default (see
section below). Now we think this default introduces too many edge
cases in normal code. We recommend always supplying scoped = TRUE. Unevaluated formulas can be handled via a is_call(x, &quot;~&quot;)
branch." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rlang</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.4.11.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../reference/lifecycle.html">Life cycle</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.tidyverse.org/blog/2020/02/glue-strings-and-tidy-eval/">Version 0.4.3</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/06/rlang-0-4-0/">Version 0.4.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2019/01/rlang-0-3-1/">Version 0.3.1</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/10/rlang-0-3-0/">Version 0.3.0</a>
    </li>
    <li>
      <a href="https://www.tidyverse.org/articles/2018/03/rlang-0.2.0/">Version 0.2.0</a>
    </li>
    <li class="divider"></li>
    <li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-lib/rlang/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Is object a formula?</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-lib/rlang/blob/master/R/formula.R'><code>R/formula.R</code></a></small>
    <div class="hidden name"><code>is_formula.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>is_formula()</code> tests whether <code>x</code> is a call to <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code>. <code>is_bare_formula()</code>
tests in addition that <code>x</code> does not inherit from anything else than
<code>"formula"</code>.</p>
<p><strong>Note</strong>: When we first implemented <code>is_formula()</code>, we thought it
best to treat unevaluated formulas as formulas by default (see
section below). Now we think this default introduces too many edge
cases in normal code. We recommend always supplying <code>scoped = TRUE</code>. Unevaluated formulas can be handled via a <code><a href='is_call.html'>is_call(x, "~")</a></code>
branch.</p>
    </div>

    <pre class="usage"><span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>x</span>, scoped <span class='op'>=</span> <span class='cn'>NULL</span>, lhs <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span>

<span class='fu'>is_bare_formula</span><span class='op'>(</span><span class='va'>x</span>, scoped <span class='op'>=</span> <span class='cn'>TRUE</span>, lhs <span class='op'>=</span> <span class='cn'>NULL</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object to test.</p></td>
    </tr>
    <tr>
      <th>scoped</th>
      <td><p>A boolean indicating whether the quosure is scoped,
that is, has a valid environment attribute and inherits from
<code>"formula"</code>. If <code>NULL</code>, the scope is not inspected.</p></td>
    </tr>
    <tr>
      <th>lhs</th>
      <td><p>A boolean indicating whether the formula has a left-hand
side. If <code>NULL</code>, the LHS is not inspected and <code>is_formula()</code>
returns <code>TRUE</code> for both one- and two-sided formulas.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="dealing-with-unevaluated-formulas"><a class="anchor" href="#dealing-with-unevaluated-formulas"></a>Dealing with unevaluated formulas</h2>

    

<p>At parse time, a formula is a simple call to <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code> and it does not
have a class or an environment. Once evaluated, the <code><a href='https://rdrr.io/r/base/tilde.html'>~</a></code> call
becomes a properly structured formula. Unevaluated formulas arise
by quotation, e.g. <code>~~foo</code>, <code><a href='https://rdrr.io/r/base/substitute.html'>quote(~foo)</a></code>, or <code><a href='https://rdrr.io/r/base/substitute.html'>substitute(arg)</a></code>
with <code>arg</code> being supplied a formula. Use the <code>scoped</code> argument to
check whether the formula carries an environment.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='op'>~</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'># If you don't supply `lhs`, both one-sided and two-sided formulas</span>
<span class='co'># will return `TRUE`</span>
<span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>disp</span> <span class='op'>~</span> <span class='va'>am</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='op'>~</span><span class='va'>am</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># You can also specify whether you expect a LHS:</span>
<span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>disp</span> <span class='op'>~</span> <span class='va'>am</span>, lhs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>disp</span> <span class='op'>~</span> <span class='va'>am</span>, lhs <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='op'>~</span><span class='va'>am</span>, lhs <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'><span class='fu'>is_formula</span><span class='op'>(</span><span class='op'>~</span><span class='va'>am</span>, lhs <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># Handling of unevaluated formulas is a bit tricky. These formulas</span>
<span class='co'># are special because they don't inherit from `"formula"` and they</span>
<span class='co'># don't carry an environment (they are not scoped):</span>
<span class='va'>f</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/substitute.html'>quote</a></span><span class='op'>(</span><span class='op'>~</span><span class='va'>foo</span><span class='op'>)</span>
<span class='fu'><a href='f_rhs.html'>f_env</a></span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>
</div><div class='output co'>#&gt; NULL</div><div class='input'>
<span class='co'># By default unevaluated formulas are treated as formulas</span>
<span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
<span class='co'># Supply `scoped = TRUE` to ensure you have an evaluated formula</span>
<span class='fu'>is_formula</span><span class='op'>(</span><span class='va'>f</span>, scoped <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'># By default unevaluated formulas not treated as bare formulas</span>
<span class='fu'>is_bare_formula</span><span class='op'>(</span><span class='va'>f</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div><div class='input'>
<span class='co'># If you supply `scoped = TRUE`, they will be considered bare</span>
<span class='co'># formulas even though they don't inherit from `"formula"`</span>
<span class='fu'>is_bare_formula</span><span class='op'>(</span><span class='va'>f</span>, scoped <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] FALSE</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Lionel Henry, <a href='http://hadley.nz'>Hadley Wickham</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


